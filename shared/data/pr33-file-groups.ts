import { FileGroup, FileChange } from '../types/PRFileTypes';

export const pr33FileGroups: FileGroup[] = [
  {
    id: 'cicd',
    name: 'CI/CD Pipeline & Workflow Configuration',
    reviewed: false,
    files: [
      { path: '.github/workflows/build.yml' },
      { path: '.github/workflows/labeled-deployment.yml' },
      { path: '.github/workflows/services-deployment-with-e2e-tests.yml' },
      { path: '.github/workflows/services-deployment.yml' },
    ]
  },
  {
    id: 'docker',
    name: 'Container Migration & Docker Configuration',
    reviewed: false,
    files: [
      { path: 'quality-gates/quality-gates-lambda/Dockerfile' },
      { path: 'quality-gates/deploy-from-local.sh' },
    ]
  },
  {
    id: 'ecs-infra',
    name: 'Infrastructure & AWS ECS Service Setup',
    reviewed: false,
    files: [
      { path: 'quality-gates/quality-gates-platform/sonarcloud/quality_gates/quality_gates_platform/ecs_service.py' },
      { path: 'quality-gates/quality-gates-platform/sonarcloud/quality_gates/quality_gates_platform/service.py' },
      { path: 'quality-gates/quality-gates-platform/sonarcloud/quality_gates/quality_gates_platform/app.py' },
      { path: 'quality-gates-events/quality-gates-events-platform/sonarcloud/quality_gates_events/quality_gates_events_platform/service.py' },
    ]
  },
  {
    id: 'app-config',
    name: 'App Config: Lambda to Container Migration',
    reviewed: false,
    files: [
      { path: 'quality-gates/quality-gates-lambda/src/main/resources/application.yml' },
      { path: 'quality-gates/quality-gates-lambda/src/main/resources/application-container.yml' },
      { path: 'quality-gates/quality-gates-lambda/src/main/resources/logback.xml' },
      { path: 'quality-gates-evaluation/quality-gates-evaluation-lambda/src/main/resources/application.yml' },
      { path: 'quality-gates-events/quality-gates-events-lambda/src/main/resources/application.yml' },
      { path: 'quality-gates/quality-gates-lambda/src/test/resources/application.yml' },
    ]
  },
  {
    id: 'event-processing',
    name: 'Event Processing Refactor & JMS Listener',
    reviewed: false,
    files: [
      { path: 'quality-gates-events/src/main/java/io/sonarcloud/qualitygate/event/SharedEventsHandler.java' },
      { path: 'quality-gates-events/src/main/java/io/sonarcloud/qualitygate/event/service/SharedEventsProcessor.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/listener/SharedEventsJmsListener.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/listener/package-info.java' },
    ]
  },
  {
    id: 'event-tests',
    name: 'Event Processing Tests Refactor',
    reviewed: false,
    files: [
      { path: 'quality-gates-events/src/test/java/io/sonarcloud/qualitygate/event/SharedEventsHandlerTest.java' },
      { path: 'quality-gates-events/src/test/java/io/sonarcloud/qualitygate/event/service/SharedEventsProcessorTest.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/listener/SharedEventsJmsListenerTest.java' },
    ]
  },
  {
    id: 'auth-refactor',
    name: 'Authorization Service Refactor',
    reviewed: false,
    files: [
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/authorization/AuthorizationService.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/authorization/AuthorizationServiceTest.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/authorization/BeanTestFactory.java' },
    ]
  },
  {
    id: 'controllers',
    name: 'API Controllers Update for Container Runtime',
    reviewed: false,
    files: [
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateProjectAssociationsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateQualityGateConditionsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateQualityGateController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateQualityGateDefaultsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateQualityGateSettingsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateQualityGateStatusesController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/ProjectAssociationsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/QualityGateConditionsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/QualityGateController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/QualityGateDefaultsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/QualityGateSettingsController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/QualityGateStatusesController.java' },
      { path: 'quality-gates-evaluation/src/main/java/io/sonarcloud/qualitygate/evaluation/controller/PrivateQualityGatesEvaluationController.java' },
      { path: 'quality-gates/src/main/java/io/sonarcloud/PrimingResource.java', deleted: true },
      { path: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/http/client/user/UsersClientFactory.java' },
    ]
  },
  {
    id: 'integration-tests',
    name: 'Integration Tests Refactor',
    reviewed: false,
    files: [
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/AbstractConditionsControllerIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/AbstractProjectAssociationsControllerIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/AbstractQualityGateControllerIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/AbstractQualityGateDefaultsControllerIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/AbstractQualityGateSettingsControllerIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ControllerBaseIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/JwtTestHelper.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ConditionsControllerDeleteIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ConditionsControllerGetIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ConditionsControllerPatchIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ConditionsControllerPostIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ProjectAssociationsControllerDeleteByOrgIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ProjectAssociationsControllerDeleteIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ProjectAssociationsControllerGetIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ProjectAssociationsControllerPostIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateControllerDeleteIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateControllerGetIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateControllerPatchIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateControllerPostIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateDefaultsControllerGetIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateDefaultsControllerPatchIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateSettingsControllerGetIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateSettingsControllerPatchIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/QualityGateStatusesControllerGetIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/interdomaincommunication/InterDomainCommunicationIT.java' },
      { path: 'quality-gates/src/test/java/io/sonarcloud/PrimingResourceTest.java', deleted: true },
    ]
  },
  {
    id: 'auth-cleanup',
    name: 'Authentication Model Cleanup',
    reviewed: false,
    files: [
      { path: 'quality-gates/shared/src/main/java/io/sonarcloud/authentication/RequestIdentity.java', deleted: true },
      { path: 'quality-gates/shared/src/main/java/io/sonarcloud/authentication/RequestIdentityProvider.java', deleted: true },
      { path: 'quality-gates/shared/src/test/java/io/sonarcloud/authentication/RequestIdentityProviderTest.java', deleted: true },
    ]
  },
  {
    id: 'openapi-snapshots',
    name: 'OpenAPI Specs & Infrastructure Snapshots',
    reviewed: false,
    files: [
      { path: 'quality-gates/quality-gates-platform/api-definitions/openapi-lambda.yaml' },
      { path: 'quality-gates/quality-gates-platform/api-definitions/openapi.yaml' },
      { path: 'quality-gates/quality-gates-platform/tests/__snapshots__/test_full_template_with_snapshot[Dev].json' },
      { path: 'quality-gates/quality-gates-platform/tests/__snapshots__/test_full_template_with_snapshot[Prod].json' },
      { path: 'quality-gates/quality-gates-platform/tests/__snapshots__/test_full_template_with_snapshot[Staging].json' },
      { path: 'quality-gates-events/quality-gates-events-platform/tests/__snapshots__/test_full_template_with_snapshot[Dev].json' },
      { path: 'quality-gates-events/quality-gates-events-platform/tests/__snapshots__/test_full_template_with_snapshot[Prod].json' },
      { path: 'quality-gates-events/quality-gates-events-platform/tests/__snapshots__/test_full_template_with_snapshot[Staging].json' },
    ]
  },
  {
    id: 'build-config',
    name: 'Build Config & Dependency Updates',
    reviewed: false,
    files: [
      { path: 'gradle/libs.versions.toml' },
      { path: 'quality-gates/quality-gates-lambda/build.gradle' },
      { path: 'quality-gates-evaluation/quality-gates-evaluation-lambda/build.gradle' },
    ]
  },
  {
    id: 'platform-tests',
    name: 'Platform Test Updates',
    reviewed: false,
    files: [
      { path: 'quality-gates/quality-gates-platform/tests/test_app.py' },
      { path: 'quality-gates/quality-gates-platform/tests/test_service.py' },
      { path: 'quality-gates/quality-gates-platform/tests/test_snapshots.py' },
    ]
  },
];

export const pr33FileChanges: FileChange[] = [
  {
    groupId: 'cicd',
    groupName: 'CI/CD Pipeline & Workflow Configuration',
    fileCount: 4,
    additions: 187,
    deletions: 94,
    needsReview: true,
    description: 'Updates to GitHub Actions workflows for build and deployment processes',
    reviewFocus: 'Review deployment workflow changes for container migration. Verify new workflow steps maintain proper deployment sequences and environment configurations. Check for any breaking changes in deployment triggers.',
    files: [
      {
        filename: '.github/workflows/build.yml',
        additions: 62,
        deletions: 31,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,8 +1,8 @@', type: 'header', content: '@@ -1,8 +1,8 @@' },
          { lineNumber: 1, type: 'context', content: 'name: Build' },
          { lineNumber: 2, type: 'context', content: 'on:' },
          { lineNumber: 3, type: 'context', content: '  push:' },
          { lineNumber: 4, type: 'context', content: '    branches: [main, develop]' },
          { lineNumber: 5, type: 'context', content: '  pull_request:' },
          { lineNumber: 6, type: 'context', content: '    branches: [main]' },
          { lineNumber: 7, type: 'context', content: 'jobs:' },
          { lineNumber: 8, type: 'context', content: '  build:' },
          { lineNumber: 9, type: 'context', content: '    runs-on: ubuntu-latest' },
          { lineNumber: 10, type: 'delete', content: '    steps:' },
          { lineNumber: 11, type: 'delete', content: '      - name: Build Lambda package' },
          { lineNumber: 12, type: 'delete', content: '        run: ./gradlew shadowJar' },
          { lineNumber: 13, type: 'delete', content: '      - name: Package Lambda' },
          { lineNumber: 14, type: 'delete', content: '        run: zip -r function.zip build/libs/*.jar' },
          { lineNumber: 10, type: 'add', content: '    steps:' },
          { lineNumber: 11, type: 'add', content: '      - name: Build application' },
          { lineNumber: 12, type: 'add', content: '        run: ./gradlew build' },
          { lineNumber: 13, type: 'add', content: '      - name: Build Docker image' },
          { lineNumber: 14, type: 'add', content: '        run: docker build -t quality-gates:${{ github.sha }} .' },
          { lineNumber: 15, type: 'add', content: '      - name: Push to ECR' },
          { lineNumber: 16, type: 'add', content: '        run: |' },
          { lineNumber: 17, type: 'add', content: '          aws ecr get-login-password | docker login --username AWS ...' },
          { lineNumber: 18, type: 'add', content: '          docker push $ECR_REGISTRY/quality-gates:${{ github.sha }}' },
        ]
      },
      {
        filename: '.github/workflows/services-deployment.yml',
        additions: 74,
        deletions: 41,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,12 +1,18 @@', type: 'header', content: '@@ -1,12 +1,18 @@' },
          { lineNumber: 1, type: 'context', content: 'name: Deploy Services' },
          { lineNumber: 2, type: 'context', content: 'on:' },
          { lineNumber: 3, type: 'context', content: '  workflow_dispatch:' },
          { lineNumber: 4, type: 'context', content: '    inputs:' },
          { lineNumber: 5, type: 'context', content: '      environment:' },
          { lineNumber: 6, type: 'context', content: "        description: 'Target environment'" },
          { lineNumber: 7, type: 'delete', content: 'jobs:' },
          { lineNumber: 8, type: 'delete', content: '  deploy-lambda:' },
          { lineNumber: 9, type: 'delete', content: '    steps:' },
          { lineNumber: 10, type: 'delete', content: '      - name: Deploy Lambda function' },
          { lineNumber: 11, type: 'delete', content: '        run: aws lambda update-function-code --function-name quality-gates ...' },
          { lineNumber: 7, type: 'add', content: 'jobs:' },
          { lineNumber: 8, type: 'add', content: '  deploy-ecs:' },
          { lineNumber: 9, type: 'add', content: '    steps:' },
          { lineNumber: 10, type: 'add', content: '      - name: Deploy ECS service' },
          { lineNumber: 11, type: 'add', content: '        run: |' },
          { lineNumber: 12, type: 'add', content: '          aws ecs update-service \\' },
          { lineNumber: 13, type: 'add', content: '            --cluster quality-gates-cluster \\' },
          { lineNumber: 14, type: 'add', content: '            --service quality-gates-service \\' },
          { lineNumber: 15, type: 'add', content: '            --force-new-deployment' },
        ]
      },
      {
        filename: '.github/workflows/labeled-deployment.yml',
        additions: 28,
        deletions: 14,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -15,10 +15,12 @@', type: 'header', content: '@@ -15,10 +15,12 @@' },
          { lineNumber: 15, type: 'context', content: '      - name: Checkout' },
          { lineNumber: 16, type: 'context', content: '        uses: actions/checkout@v3' },
          { lineNumber: 17, type: 'delete', content: '      - name: Deploy to Lambda ${{ inputs.environment }}' },
          { lineNumber: 18, type: 'delete', content: '        run: aws lambda update-function-code ...' },
          { lineNumber: 17, type: 'add', content: '      - name: Deploy ECS task to ${{ inputs.environment }}' },
          { lineNumber: 18, type: 'add', content: '        run: |' },
          { lineNumber: 19, type: 'add', content: '          IMAGE_TAG=$(git rev-parse --short HEAD)' },
          { lineNumber: 20, type: 'add', content: '          ./scripts/deploy-ecs.sh ${{ inputs.environment }} $IMAGE_TAG' },
        ]
      },
      {
        filename: '.github/workflows/services-deployment-with-e2e-tests.yml',
        additions: 23,
        deletions: 8,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -30,8 +30,14 @@', type: 'header', content: '@@ -30,8 +30,14 @@' },
          { lineNumber: 30, type: 'context', content: '  e2e-tests:' },
          { lineNumber: 31, type: 'context', content: '    needs: deploy' },
          { lineNumber: 32, type: 'context', content: '    runs-on: ubuntu-latest' },
          { lineNumber: 33, type: 'delete', content: '    env:' },
          { lineNumber: 34, type: 'delete', content: '      LAMBDA_ENDPOINT: ${{ secrets.LAMBDA_ENDPOINT }}' },
          { lineNumber: 33, type: 'add', content: '    env:' },
          { lineNumber: 34, type: 'add', content: '      SERVICE_ENDPOINT: ${{ secrets.ECS_SERVICE_ENDPOINT }}' },
          { lineNumber: 35, type: 'add', content: '      CONTAINER_PORT: 8080' },
        ]
      },
    ]
  },
  {
    groupId: 'docker',
    groupName: 'Container Migration & Docker Configuration',
    fileCount: 2,
    additions: 89,
    deletions: 0,
    needsReview: true,
    description: 'Dockerfile updates and deployment scripts for lambda-to-container migration',
    reviewFocus: 'Examine Dockerfile changes for base image, build stages, and runtime config. Review deploy-from-local.sh script for deployment procedures. Ensure container configurations align with AWS ECS requirements.',
    files: [
      {
        filename: 'quality-gates/quality-gates-lambda/Dockerfile',
        additions: 54,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,54 @@', type: 'header', content: '@@ -0,0 +1,54 @@' },
          { lineNumber: 1, type: 'add', content: '# Build stage' },
          { lineNumber: 2, type: 'add', content: 'FROM amazoncorretto:17-alpine AS build' },
          { lineNumber: 3, type: 'add', content: 'WORKDIR /app' },
          { lineNumber: 4, type: 'add', content: 'COPY gradlew .' },
          { lineNumber: 5, type: 'add', content: 'COPY gradle gradle' },
          { lineNumber: 6, type: 'add', content: 'COPY build.gradle settings.gradle .' },
          { lineNumber: 7, type: 'add', content: 'COPY src src' },
          { lineNumber: 8, type: 'add', content: 'RUN ./gradlew build -x test --no-daemon' },
          { lineNumber: 9, type: 'add', content: '' },
          { lineNumber: 10, type: 'add', content: '# Runtime stage' },
          { lineNumber: 11, type: 'add', content: 'FROM amazoncorretto:17-alpine' },
          { lineNumber: 12, type: 'add', content: 'WORKDIR /app' },
          { lineNumber: 13, type: 'add', content: 'RUN addgroup -S appgroup && adduser -S appuser -G appgroup' },
          { lineNumber: 14, type: 'add', content: 'COPY --from=build /app/build/libs/*.jar app.jar' },
          { lineNumber: 15, type: 'add', content: 'USER appuser' },
          { lineNumber: 16, type: 'add', content: 'EXPOSE 8080' },
          { lineNumber: 17, type: 'add', content: 'HEALTHCHECK --interval=30s --timeout=10s \\' },
          { lineNumber: 18, type: 'add', content: '  CMD wget -qO- http://localhost:8080/actuator/health || exit 1' },
          { lineNumber: 19, type: 'add', content: 'ENTRYPOINT ["java", "-jar", "/app/app.jar", "--spring.profiles.active=container"]' },
        ]
      },
      {
        filename: 'quality-gates/deploy-from-local.sh',
        additions: 35,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,35 @@', type: 'header', content: '@@ -0,0 +1,35 @@' },
          { lineNumber: 1, type: 'add', content: '#!/bin/bash' },
          { lineNumber: 2, type: 'add', content: 'set -euo pipefail' },
          { lineNumber: 3, type: 'add', content: '' },
          { lineNumber: 4, type: 'add', content: 'ENVIRONMENT=${1:-dev}' },
          { lineNumber: 5, type: 'add', content: 'IMAGE_TAG=${2:-latest}' },
          { lineNumber: 6, type: 'add', content: 'ECR_REGISTRY="123456789.dkr.ecr.eu-west-1.amazonaws.com"' },
          { lineNumber: 7, type: 'add', content: 'IMAGE_NAME="quality-gates"' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: 'echo "Building Docker image..."' },
          { lineNumber: 10, type: 'add', content: 'docker build -t $IMAGE_NAME:$IMAGE_TAG .' },
          { lineNumber: 11, type: 'add', content: '' },
          { lineNumber: 12, type: 'add', content: 'echo "Pushing to ECR..."' },
          { lineNumber: 13, type: 'add', content: 'aws ecr get-login-password --region eu-west-1 | \\' },
          { lineNumber: 14, type: 'add', content: '  docker login --username AWS --password-stdin $ECR_REGISTRY' },
          { lineNumber: 15, type: 'add', content: 'docker tag $IMAGE_NAME:$IMAGE_TAG $ECR_REGISTRY/$IMAGE_NAME:$IMAGE_TAG' },
          { lineNumber: 16, type: 'add', content: 'docker push $ECR_REGISTRY/$IMAGE_NAME:$IMAGE_TAG' },
          { lineNumber: 17, type: 'add', content: '' },
          { lineNumber: 18, type: 'add', content: 'echo "Deploying to ECS ($ENVIRONMENT)..."' },
          { lineNumber: 19, type: 'add', content: 'aws ecs update-service --cluster quality-gates-$ENVIRONMENT \\' },
          { lineNumber: 20, type: 'add', content: '  --service quality-gates-service --force-new-deployment' },
          { lineNumber: 21, type: 'add', content: 'echo "Deployment initiated successfully."' },
        ]
      },
    ]
  },
  {
    groupId: 'ecs-infra',
    groupName: 'Infrastructure & AWS ECS Service Setup',
    fileCount: 4,
    additions: 312,
    deletions: 18,
    needsReview: true,
    description: 'New ECS service definitions and infrastructure templates for container deployment',
    reviewFocus: 'Verify ECS service configuration including task definitions, load balancers, and auto-scaling. Review infrastructure-as-code changes in platform service files. Check resource allocation and networking setup for containers.',
    files: [
      {
        filename: 'quality-gates/quality-gates-platform/sonarcloud/quality_gates/quality_gates_platform/ecs_service.py',
        additions: 148,
        deletions: 0,
        coverage: 72,
        duplications: 3,
        issues: 1,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,148 @@', type: 'header', content: '@@ -0,0 +1,148 @@' },
          { lineNumber: 1, type: 'add', content: 'from aws_cdk import (aws_ecs as ecs, aws_ecs_patterns as ecs_patterns,' },
          { lineNumber: 2, type: 'add', content: '    aws_elasticloadbalancingv2 as elbv2, aws_ec2 as ec2)' },
          { lineNumber: 3, type: 'add', content: 'from constructs import Construct' },
          { lineNumber: 4, type: 'add', content: '' },
          { lineNumber: 5, type: 'add', content: 'class QualityGatesEcsService(Construct):' },
          { lineNumber: 6, type: 'add', content: '    def __init__(self, scope: Construct, id: str, **kwargs):' },
          { lineNumber: 7, type: 'add', content: '        super().__init__(scope, id, **kwargs)' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: '        self.task_definition = ecs.FargateTaskDefinition(' },
          { lineNumber: 10, type: 'add', content: '            self, "TaskDef",' },
          { lineNumber: 11, type: 'add', content: '            memory_limit_mib=2048,' },
          { lineNumber: 12, type: 'add', content: '            cpu=1024,' },
          { lineNumber: 13, type: 'add', content: '        )' },
          { lineNumber: 14, type: 'add', content: '' },
          { lineNumber: 15, type: 'add', content: '        self.container = self.task_definition.add_container(' },
          { lineNumber: 16, type: 'add', content: '            "QualityGatesContainer",' },
          { lineNumber: 17, type: 'add', content: '            image=ecs.ContainerImage.from_ecr_repository(ecr_repo),' },
          { lineNumber: 18, type: 'add', content: '            logging=ecs.LogDrivers.aws_logs(stream_prefix="quality-gates"),' },
          { lineNumber: 19, type: 'add', content: '            environment={"SPRING_PROFILES_ACTIVE": "container"},' },
          { lineNumber: 20, type: 'add', content: '        )' },
          { lineNumber: 21, type: 'add', content: '        self.container.add_port_mappings(ecs.PortMapping(container_port=8080))' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-platform/sonarcloud/quality_gates/quality_gates_platform/service.py',
        additions: 96,
        deletions: 12,
        coverage: 68,
        duplications: 2,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -8,16 +8,22 @@', type: 'header', content: '@@ -8,16 +8,22 @@' },
          { lineNumber: 8, type: 'context', content: 'class QualityGatesPlatformService(Stack):' },
          { lineNumber: 9, type: 'context', content: '    def __init__(self, scope, id, **kwargs):' },
          { lineNumber: 10, type: 'context', content: '        super().__init__(scope, id, **kwargs)' },
          { lineNumber: 11, type: 'delete', content: '        self.lambda_function = aws_lambda.Function(' },
          { lineNumber: 12, type: 'delete', content: '            self, "QualityGatesLambda",' },
          { lineNumber: 13, type: 'delete', content: '            runtime=aws_lambda.Runtime.JAVA_17,' },
          { lineNumber: 14, type: 'delete', content: '            handler="io.sonarcloud.Handler::handleRequest",' },
          { lineNumber: 15, type: 'delete', content: '            code=aws_lambda.Code.from_asset("../build/function.zip"),' },
          { lineNumber: 16, type: 'delete', content: '        )' },
          { lineNumber: 11, type: 'add', content: '        self.ecs_service = QualityGatesEcsService(self, "EcsService")' },
          { lineNumber: 12, type: 'add', content: '        self.alb = elbv2.ApplicationLoadBalancer(' },
          { lineNumber: 13, type: 'add', content: '            self, "ALB", internet_facing=True' },
          { lineNumber: 14, type: 'add', content: '        )' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-platform/sonarcloud/quality_gates/quality_gates_platform/app.py',
        additions: 44,
        deletions: 6,
        coverage: 61,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,10 +1,14 @@', type: 'header', content: '@@ -1,10 +1,14 @@' },
          { lineNumber: 1, type: 'context', content: 'import aws_cdk as cdk' },
          { lineNumber: 2, type: 'context', content: 'from quality_gates_platform.service import QualityGatesPlatformService' },
          { lineNumber: 3, type: 'add', content: 'from quality_gates_platform.ecs_service import QualityGatesEcsService' },
          { lineNumber: 4, type: 'context', content: '' },
          { lineNumber: 5, type: 'context', content: 'app = cdk.App()' },
          { lineNumber: 6, type: 'delete', content: 'QualityGatesPlatformService(app, "QualityGatesPlatformService-Lambda")' },
          { lineNumber: 6, type: 'add', content: 'QualityGatesPlatformService(app, "QualityGatesPlatformService-Container")' },
          { lineNumber: 7, type: 'context', content: 'app.synth()' },
        ]
      },
      {
        filename: 'quality-gates-events/quality-gates-events-platform/sonarcloud/quality_gates_events/quality_gates_events_platform/service.py',
        additions: 24,
        deletions: 0,
        coverage: 74,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -18,6 +18,16 @@', type: 'header', content: '@@ -18,6 +18,16 @@' },
          { lineNumber: 18, type: 'context', content: 'class QualityGatesEventsPlatformService(Stack):' },
          { lineNumber: 19, type: 'context', content: '    def __init__(self, scope, id, **kwargs):' },
          { lineNumber: 20, type: 'context', content: '        super().__init__(scope, id, **kwargs)' },
          { lineNumber: 21, type: 'add', content: '        self.ecs_service = QualityGatesEcsService(' },
          { lineNumber: 22, type: 'add', content: '            self, "EventsEcsService",' },
          { lineNumber: 23, type: 'add', content: '            memory_limit_mib=1024,' },
          { lineNumber: 24, type: 'add', content: '        )' },
        ]
      },
    ]
  },
  {
    groupId: 'app-config',
    groupName: 'App Config: Lambda to Container Migration',
    fileCount: 6,
    additions: 156,
    deletions: 43,
    needsReview: true,
    description: 'Application configuration updates for container runtime environment and JMS messaging',
    reviewFocus: 'Review application.yml changes for container profile configurations, JMS queue settings, and endpoint mappings. Verify container-specific configs in application-container.yml. Check logging configuration updates in logback.xml.',
    files: [
      {
        filename: 'quality-gates/quality-gates-lambda/src/main/resources/application.yml',
        additions: 28,
        deletions: 19,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,22 +1,26 @@', type: 'header', content: '@@ -1,22 +1,26 @@' },
          { lineNumber: 1, type: 'context', content: 'spring:' },
          { lineNumber: 2, type: 'context', content: '  application:' },
          { lineNumber: 3, type: 'context', content: '    name: quality-gates' },
          { lineNumber: 4, type: 'delete', content: '  cloud:' },
          { lineNumber: 5, type: 'delete', content: '    function:' },
          { lineNumber: 6, type: 'delete', content: '      definition: handleRequest' },
          { lineNumber: 7, type: 'delete', content: '  main:' },
          { lineNumber: 8, type: 'delete', content: '    web-application-type: none' },
          { lineNumber: 4, type: 'add', content: '  profiles:' },
          { lineNumber: 5, type: 'add', content: '    active: ${SPRING_PROFILES_ACTIVE:default}' },
          { lineNumber: 6, type: 'add', content: '  jms:' },
          { lineNumber: 7, type: 'add', content: '    listener:' },
          { lineNumber: 8, type: 'add', content: '      auto-startup: true' },
          { lineNumber: 9, type: 'add', content: '      concurrency: 5-10' },
          { lineNumber: 10, type: 'context', content: '' },
          { lineNumber: 11, type: 'context', content: 'server:' },
          { lineNumber: 12, type: 'add', content: '  port: ${SERVER_PORT:8080}' },
          { lineNumber: 13, type: 'context', content: '' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-lambda/src/main/resources/application-container.yml',
        additions: 52,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,52 @@', type: 'header', content: '@@ -0,0 +1,52 @@' },
          { lineNumber: 1, type: 'add', content: '# Container-specific configuration profile' },
          { lineNumber: 2, type: 'add', content: 'spring:' },
          { lineNumber: 3, type: 'add', content: '  datasource:' },
          { lineNumber: 4, type: 'add', content: '    url: jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}' },
          { lineNumber: 5, type: 'add', content: '    username: ${DB_USER}' },
          { lineNumber: 6, type: 'add', content: '    password: ${DB_PASSWORD}' },
          { lineNumber: 7, type: 'add', content: '  activemq:' },
          { lineNumber: 8, type: 'add', content: '    broker-url: tcp://${ACTIVEMQ_HOST}:61616' },
          { lineNumber: 9, type: 'add', content: '    user: ${ACTIVEMQ_USER}' },
          { lineNumber: 10, type: 'add', content: '    password: ${ACTIVEMQ_PASSWORD}' },
          { lineNumber: 11, type: 'add', content: '' },
          { lineNumber: 12, type: 'add', content: 'management:' },
          { lineNumber: 13, type: 'add', content: '  endpoints:' },
          { lineNumber: 14, type: 'add', content: '    web:' },
          { lineNumber: 15, type: 'add', content: '      exposure:' },
          { lineNumber: 16, type: 'add', content: '        include: health,info,prometheus' },
          { lineNumber: 17, type: 'add', content: '  health:' },
          { lineNumber: 18, type: 'add', content: '    livenessState:' },
          { lineNumber: 19, type: 'add', content: '      enabled: true' },
          { lineNumber: 20, type: 'add', content: '    readinessState:' },
          { lineNumber: 21, type: 'add', content: '      enabled: true' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-lambda/src/main/resources/logback.xml',
        additions: 18,
        deletions: 12,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -4,14 +4,16 @@', type: 'header', content: '@@ -4,14 +4,16 @@' },
          { lineNumber: 4, type: 'context', content: '<configuration>' },
          { lineNumber: 5, type: 'delete', content: '  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">' },
          { lineNumber: 6, type: 'delete', content: '    <encoder><pattern>%d{HH:mm:ss} [%thread] %-5level %logger - %msg%n</pattern></encoder>' },
          { lineNumber: 7, type: 'delete', content: '  </appender>' },
          { lineNumber: 5, type: 'add', content: '  <appender name="JSON_STDOUT" class="ch.qos.logback.core.ConsoleAppender">' },
          { lineNumber: 6, type: 'add', content: '    <encoder class="net.logstash.logback.encoder.LogstashEncoder">' },
          { lineNumber: 7, type: 'add', content: '      <includeMdcKeyName>traceId</includeMdcKeyName>' },
          { lineNumber: 8, type: 'add', content: '      <includeMdcKeyName>spanId</includeMdcKeyName>' },
          { lineNumber: 9, type: 'add', content: '    </encoder>' },
          { lineNumber: 10, type: 'add', content: '  </appender>' },
          { lineNumber: 11, type: 'context', content: '  <root level="INFO">' },
          { lineNumber: 12, type: 'delete', content: '    <appender-ref ref="STDOUT" />' },
          { lineNumber: 12, type: 'add', content: '    <appender-ref ref="JSON_STDOUT" />' },
          { lineNumber: 13, type: 'context', content: '  </root>' },
          { lineNumber: 14, type: 'context', content: '</configuration>' },
        ]
      },
      {
        filename: 'quality-gates-evaluation/quality-gates-evaluation-lambda/src/main/resources/application.yml',
        additions: 22,
        deletions: 8,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,10 +1,16 @@', type: 'header', content: '@@ -1,10 +1,16 @@' },
          { lineNumber: 1, type: 'context', content: 'spring:' },
          { lineNumber: 2, type: 'context', content: '  application:' },
          { lineNumber: 3, type: 'context', content: '    name: quality-gates-evaluation' },
          { lineNumber: 4, type: 'delete', content: '  cloud:' },
          { lineNumber: 5, type: 'delete', content: '    function:' },
          { lineNumber: 6, type: 'delete', content: '      definition: evaluate' },
          { lineNumber: 4, type: 'add', content: '  profiles:' },
          { lineNumber: 5, type: 'add', content: '    active: ${SPRING_PROFILES_ACTIVE:default}' },
          { lineNumber: 6, type: 'add', content: '  jms:' },
          { lineNumber: 7, type: 'add', content: '    listener:' },
          { lineNumber: 8, type: 'add', content: '      auto-startup: true' },
        ]
      },
      {
        filename: 'quality-gates-events/quality-gates-events-lambda/src/main/resources/application.yml',
        additions: 20,
        deletions: 4,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,6 +1,10 @@', type: 'header', content: '@@ -1,6 +1,10 @@' },
          { lineNumber: 1, type: 'context', content: 'spring:' },
          { lineNumber: 2, type: 'context', content: '  application:' },
          { lineNumber: 3, type: 'context', content: '    name: quality-gates-events' },
          { lineNumber: 4, type: 'delete', content: '  main:' },
          { lineNumber: 5, type: 'delete', content: '    web-application-type: none' },
          { lineNumber: 4, type: 'add', content: '  activemq:' },
          { lineNumber: 5, type: 'add', content: '    broker-url: tcp://${ACTIVEMQ_HOST:localhost}:61616' },
          { lineNumber: 6, type: 'add', content: '  jms:' },
          { lineNumber: 7, type: 'add', content: '    pub-sub-domain: false' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-lambda/src/test/resources/application.yml',
        additions: 16,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,16 @@', type: 'header', content: '@@ -0,0 +1,16 @@' },
          { lineNumber: 1, type: 'add', content: 'spring:' },
          { lineNumber: 2, type: 'add', content: '  profiles:' },
          { lineNumber: 3, type: 'add', content: '    active: test' },
          { lineNumber: 4, type: 'add', content: '  activemq:' },
          { lineNumber: 5, type: 'add', content: '    broker-url: vm://embedded?broker.persistent=false' },
          { lineNumber: 6, type: 'add', content: '    in-memory: true' },
          { lineNumber: 7, type: 'add', content: '' },
          { lineNumber: 8, type: 'add', content: 'server:' },
          { lineNumber: 9, type: 'add', content: '  port: 0' },
        ]
      },
    ]
  },
  {
    groupId: 'event-processing',
    groupName: 'Event Processing Refactor & JMS Listener',
    fileCount: 4,
    additions: 198,
    deletions: 87,
    needsReview: true,
    description: 'Refactored event handling from Lambda handler to service layer with new JMS listener for container',
    reviewFocus: 'Review SharedEventsProcessor extraction from SharedEventsHandler for service layer separation. Examine new SharedEventsJmsListener for message consumption in containerized environment. Verify event processing logic remains unchanged.',
    files: [
      {
        filename: 'quality-gates-events/src/main/java/io/sonarcloud/qualitygate/event/SharedEventsHandler.java',
        additions: 8,
        deletions: 52,
        coverage: 88,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,58 +1,14 @@', type: 'header', content: '@@ -1,58 +1,14 @@' },
          { lineNumber: 1, type: 'context', content: 'package io.sonarcloud.qualitygate.event;' },
          { lineNumber: 2, type: 'context', content: '' },
          { lineNumber: 3, type: 'delete', content: 'import com.amazonaws.services.lambda.runtime.Context;' },
          { lineNumber: 4, type: 'delete', content: 'import com.amazonaws.services.lambda.runtime.RequestHandler;' },
          { lineNumber: 5, type: 'delete', content: '' },
          { lineNumber: 6, type: 'delete', content: 'public class SharedEventsHandler implements RequestHandler<SharedEvent, Void> {' },
          { lineNumber: 7, type: 'delete', content: '' },
          { lineNumber: 8, type: 'delete', content: '  @Override' },
          { lineNumber: 9, type: 'delete', content: '  public Void handleRequest(SharedEvent event, Context context) {' },
          { lineNumber: 10, type: 'delete', content: '    // Processing logic directly in handler' },
          { lineNumber: 11, type: 'delete', content: '    validateEvent(event);' },
          { lineNumber: 12, type: 'delete', content: '    processSharedEvent(event);' },
          { lineNumber: 13, type: 'delete', content: '    return null;' },
          { lineNumber: 14, type: 'delete', content: '  }' },
          { lineNumber: 3, type: 'add', content: 'import org.springframework.stereotype.Component;' },
          { lineNumber: 4, type: 'add', content: '' },
          { lineNumber: 5, type: 'add', content: '@Component' },
          { lineNumber: 6, type: 'add', content: 'public class SharedEventsHandler {' },
          { lineNumber: 7, type: 'add', content: '  private final SharedEventsProcessor processor;' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: '  public void handle(SharedEvent event) {' },
          { lineNumber: 10, type: 'add', content: '    processor.process(event);' },
          { lineNumber: 11, type: 'add', content: '  }' },
          { lineNumber: 12, type: 'add', content: '}' },
        ]
      },
      {
        filename: 'quality-gates-events/src/main/java/io/sonarcloud/qualitygate/event/service/SharedEventsProcessor.java',
        additions: 87,
        deletions: 0,
        coverage: 91,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,87 @@', type: 'header', content: '@@ -0,0 +1,87 @@' },
          { lineNumber: 1, type: 'add', content: 'package io.sonarcloud.qualitygate.event.service;' },
          { lineNumber: 2, type: 'add', content: '' },
          { lineNumber: 3, type: 'add', content: 'import org.springframework.stereotype.Service;' },
          { lineNumber: 4, type: 'add', content: 'import org.springframework.transaction.annotation.Transactional;' },
          { lineNumber: 5, type: 'add', content: '' },
          { lineNumber: 6, type: 'add', content: '@Service' },
          { lineNumber: 7, type: 'add', content: 'public class SharedEventsProcessor {' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: '  private final SharedEventValidator validator;' },
          { lineNumber: 10, type: 'add', content: '  private final SharedEventRepository repository;' },
          { lineNumber: 11, type: 'add', content: '' },
          { lineNumber: 12, type: 'add', content: '  @Transactional' },
          { lineNumber: 13, type: 'add', content: '  public void process(SharedEvent event) {' },
          { lineNumber: 14, type: 'add', content: '    validator.validate(event);' },
          { lineNumber: 15, type: 'add', content: '    SharedEventEntity entity = SharedEventMapper.toEntity(event);' },
          { lineNumber: 16, type: 'add', content: '    repository.save(entity);' },
          { lineNumber: 17, type: 'add', content: '    publishProcessedEvent(entity);' },
          { lineNumber: 18, type: 'add', content: '  }' },
          { lineNumber: 19, type: 'add', content: '' },
          { lineNumber: 20, type: 'add', content: '  private void publishProcessedEvent(SharedEventEntity entity) {' },
          { lineNumber: 21, type: 'add', content: '    // Publish to downstream consumers' },
          { lineNumber: 22, type: 'add', content: '  }' },
          { lineNumber: 23, type: 'add', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/listener/SharedEventsJmsListener.java',
        additions: 62,
        deletions: 0,
        coverage: 85,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,62 @@', type: 'header', content: '@@ -0,0 +1,62 @@' },
          { lineNumber: 1, type: 'add', content: 'package io.sonarcloud.qualitygate.listener;' },
          { lineNumber: 2, type: 'add', content: '' },
          { lineNumber: 3, type: 'add', content: 'import org.springframework.jms.annotation.JmsListener;' },
          { lineNumber: 4, type: 'add', content: 'import org.springframework.stereotype.Component;' },
          { lineNumber: 5, type: 'add', content: '' },
          { lineNumber: 6, type: 'add', content: '@Component' },
          { lineNumber: 7, type: 'add', content: 'public class SharedEventsJmsListener {' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: '  private final SharedEventsHandler handler;' },
          { lineNumber: 10, type: 'add', content: '' },
          { lineNumber: 11, type: 'add', content: '  @JmsListener(destination = "${jms.queue.shared-events}",' },
          { lineNumber: 12, type: 'add', content: '               containerFactory = "jmsListenerContainerFactory")' },
          { lineNumber: 13, type: 'add', content: '  public void onMessage(SharedEvent event) {' },
          { lineNumber: 14, type: 'add', content: '    handler.handle(event);' },
          { lineNumber: 15, type: 'add', content: '  }' },
          { lineNumber: 16, type: 'add', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/listener/package-info.java',
        additions: 4,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,4 @@', type: 'header', content: '@@ -0,0 +1,4 @@' },
          { lineNumber: 1, type: 'add', content: '/**' },
          { lineNumber: 2, type: 'add', content: ' * JMS listeners for container-based event consumption.' },
          { lineNumber: 3, type: 'add', content: ' */' },
          { lineNumber: 4, type: 'add', content: 'package io.sonarcloud.qualitygate.listener;' },
        ]
      },
    ]
  },
  {
    groupId: 'event-tests',
    groupName: 'Event Processing Tests Refactor',
    fileCount: 3,
    additions: 142,
    deletions: 68,
    needsReview: true,
    description: 'Updated tests for refactored event processing service layer',
    reviewFocus: 'Ensure test coverage migrated from handler tests to new SharedEventsProcessorTest. Verify SharedEventsHandlerTest updated to reflect delegation pattern. Check SharedEventsJmsListenerTest covers message consumption scenarios.',
    files: [
      {
        filename: 'quality-gates-events/src/test/java/io/sonarcloud/qualitygate/event/SharedEventsHandlerTest.java',
        additions: 24,
        deletions: 61,
        coverage: 88,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,65 +1,28 @@', type: 'header', content: '@@ -1,65 +1,28 @@' },
          { lineNumber: 1, type: 'context', content: 'package io.sonarcloud.qualitygate.event;' },
          { lineNumber: 2, type: 'context', content: '' },
          { lineNumber: 3, type: 'delete', content: 'import com.amazonaws.services.lambda.runtime.Context;' },
          { lineNumber: 4, type: 'delete', content: 'import static org.mockito.Mockito.*;' },
          { lineNumber: 3, type: 'add', content: 'import org.junit.jupiter.api.Test;' },
          { lineNumber: 4, type: 'add', content: 'import org.mockito.InjectMocks;' },
          { lineNumber: 5, type: 'add', content: 'import org.mockito.Mock;' },
          { lineNumber: 6, type: 'add', content: '' },
          { lineNumber: 7, type: 'context', content: 'class SharedEventsHandlerTest {' },
          { lineNumber: 8, type: 'delete', content: '  @Test void handleRequest_callsProcessSharedEvent() {' },
          { lineNumber: 9, type: 'delete', content: '    SharedEventsHandler handler = new SharedEventsHandler();' },
          { lineNumber: 10, type: 'delete', content: '    Context ctx = mock(Context.class);' },
          { lineNumber: 11, type: 'delete', content: '    handler.handleRequest(testEvent(), ctx);' },
          { lineNumber: 12, type: 'delete', content: '    verify(handler, times(1)).processSharedEvent(any());' },
          { lineNumber: 13, type: 'delete', content: '  }' },
          { lineNumber: 8, type: 'add', content: '  @Mock SharedEventsProcessor processor;' },
          { lineNumber: 9, type: 'add', content: '  @InjectMocks SharedEventsHandler handler;' },
          { lineNumber: 10, type: 'add', content: '' },
          { lineNumber: 11, type: 'add', content: '  @Test void handle_delegatesToProcessor() {' },
          { lineNumber: 12, type: 'add', content: '    SharedEvent event = testEvent();' },
          { lineNumber: 13, type: 'add', content: '    handler.handle(event);' },
          { lineNumber: 14, type: 'add', content: '    verify(processor).process(event);' },
          { lineNumber: 15, type: 'add', content: '  }' },
          { lineNumber: 16, type: 'context', content: '}' },
        ]
      },
      {
        filename: 'quality-gates-events/src/test/java/io/sonarcloud/qualitygate/event/service/SharedEventsProcessorTest.java',
        additions: 89,
        deletions: 0,
        coverage: 94,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,89 @@', type: 'header', content: '@@ -0,0 +1,89 @@' },
          { lineNumber: 1, type: 'add', content: 'package io.sonarcloud.qualitygate.event.service;' },
          { lineNumber: 2, type: 'add', content: '' },
          { lineNumber: 3, type: 'add', content: 'import org.junit.jupiter.api.Test;' },
          { lineNumber: 4, type: 'add', content: 'import org.junit.jupiter.api.extension.ExtendWith;' },
          { lineNumber: 5, type: 'add', content: 'import org.mockito.InjectMocks;' },
          { lineNumber: 6, type: 'add', content: 'import org.mockito.Mock;' },
          { lineNumber: 7, type: 'add', content: '' },
          { lineNumber: 8, type: 'add', content: 'class SharedEventsProcessorTest {' },
          { lineNumber: 9, type: 'add', content: '' },
          { lineNumber: 10, type: 'add', content: '  @Mock SharedEventValidator validator;' },
          { lineNumber: 11, type: 'add', content: '  @Mock SharedEventRepository repository;' },
          { lineNumber: 12, type: 'add', content: '  @InjectMocks SharedEventsProcessor processor;' },
          { lineNumber: 13, type: 'add', content: '' },
          { lineNumber: 14, type: 'add', content: '  @Test void process_validatesAndPersistsEvent() {' },
          { lineNumber: 15, type: 'add', content: '    SharedEvent event = TestFixtures.sharedEvent();' },
          { lineNumber: 16, type: 'add', content: '    processor.process(event);' },
          { lineNumber: 17, type: 'add', content: '    verify(validator).validate(event);' },
          { lineNumber: 18, type: 'add', content: '    verify(repository).save(any(SharedEventEntity.class));' },
          { lineNumber: 19, type: 'add', content: '  }' },
          { lineNumber: 20, type: 'add', content: '' },
          { lineNumber: 21, type: 'add', content: '  @Test void process_invalidEvent_throwsValidationException() {' },
          { lineNumber: 22, type: 'add', content: '    doThrow(ValidationException.class).when(validator).validate(any());' },
          { lineNumber: 23, type: 'add', content: '    assertThrows(ValidationException.class, () -> processor.process(invalidEvent()));' },
          { lineNumber: 24, type: 'add', content: '  }' },
          { lineNumber: 25, type: 'add', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/listener/SharedEventsJmsListenerTest.java',
        additions: 29,
        deletions: 0,
        coverage: 87,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,29 @@', type: 'header', content: '@@ -0,0 +1,29 @@' },
          { lineNumber: 1, type: 'add', content: 'package io.sonarcloud.qualitygate.listener;' },
          { lineNumber: 2, type: 'add', content: '' },
          { lineNumber: 3, type: 'add', content: 'class SharedEventsJmsListenerTest {' },
          { lineNumber: 4, type: 'add', content: '' },
          { lineNumber: 5, type: 'add', content: '  @Mock SharedEventsHandler handler;' },
          { lineNumber: 6, type: 'add', content: '  @InjectMocks SharedEventsJmsListener listener;' },
          { lineNumber: 7, type: 'add', content: '' },
          { lineNumber: 8, type: 'add', content: '  @Test void onMessage_delegatesToHandler() {' },
          { lineNumber: 9, type: 'add', content: '    SharedEvent event = TestFixtures.sharedEvent();' },
          { lineNumber: 10, type: 'add', content: '    listener.onMessage(event);' },
          { lineNumber: 11, type: 'add', content: '    verify(handler).handle(event);' },
          { lineNumber: 12, type: 'add', content: '  }' },
          { lineNumber: 13, type: 'add', content: '}' },
        ]
      },
    ]
  },
  {
    groupId: 'auth-refactor',
    groupName: 'Authorization Service Refactor',
    fileCount: 3,
    additions: 134,
    deletions: 96,
    needsReview: true,
    description: 'Major refactoring of AuthorizationService with related test updates',
    reviewFocus: 'Review AuthorizationService changes for logic improvements and interface modifications. Ensure authorization logic correctness is maintained. Verify comprehensive test coverage in AuthorizationServiceTest addresses all refactored scenarios.',
    files: [
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/authorization/AuthorizationService.java',
        additions: 68,
        deletions: 54,
        coverage: 89,
        duplications: 0,
        issues: 1,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,58 +1,72 @@', type: 'header', content: '@@ -1,58 +1,72 @@' },
          { lineNumber: 1, type: 'context', content: 'package io.sonarcloud.qualitygate.authorization;' },
          { lineNumber: 2, type: 'context', content: '' },
          { lineNumber: 3, type: 'delete', content: 'import io.sonarcloud.authentication.RequestIdentity;' },
          { lineNumber: 4, type: 'delete', content: 'import io.sonarcloud.authentication.RequestIdentityProvider;' },
          { lineNumber: 3, type: 'add', content: 'import io.sonarcloud.authentication.JwtTokenValidator;' },
          { lineNumber: 4, type: 'add', content: 'import io.sonarcloud.authentication.UserContext;' },
          { lineNumber: 5, type: 'context', content: '' },
          { lineNumber: 6, type: 'context', content: '@Service' },
          { lineNumber: 7, type: 'context', content: 'public class AuthorizationService {' },
          { lineNumber: 8, type: 'delete', content: '  private final RequestIdentityProvider identityProvider;' },
          { lineNumber: 8, type: 'add', content: '  private final JwtTokenValidator jwtValidator;' },
          { lineNumber: 9, type: 'add', content: '  private final UserContext userContext;' },
          { lineNumber: 10, type: 'context', content: '' },
          { lineNumber: 11, type: 'delete', content: '  public boolean isAuthorized(String userId, String resource) {' },
          { lineNumber: 12, type: 'delete', content: '    RequestIdentity identity = identityProvider.get();' },
          { lineNumber: 13, type: 'delete', content: '    return identity.getUserId().equals(userId) && hasPermission(identity, resource);' },
          { lineNumber: 14, type: 'delete', content: '  }' },
          { lineNumber: 11, type: 'add', content: '  public boolean isAuthorized(String bearerToken, String resource) {' },
          { lineNumber: 12, type: 'add', content: '    UserPrincipal principal = jwtValidator.validate(bearerToken);' },
          { lineNumber: 13, type: 'add', content: '    return hasPermission(principal, resource);' },
          { lineNumber: 14, type: 'add', content: '  }' },
        ]
      },
      {
        filename: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/authorization/AuthorizationServiceTest.java',
        additions: 52,
        deletions: 38,
        coverage: 93,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,42 +1,56 @@', type: 'header', content: '@@ -1,42 +1,56 @@' },
          { lineNumber: 1, type: 'context', content: 'class AuthorizationServiceTest {' },
          { lineNumber: 2, type: 'delete', content: '  @Mock RequestIdentityProvider identityProvider;' },
          { lineNumber: 2, type: 'add', content: '  @Mock JwtTokenValidator jwtValidator;' },
          { lineNumber: 3, type: 'add', content: '  @Mock UserContext userContext;' },
          { lineNumber: 4, type: 'context', content: '  @InjectMocks AuthorizationService authorizationService;' },
          { lineNumber: 5, type: 'context', content: '' },
          { lineNumber: 6, type: 'delete', content: '  @Test void isAuthorized_withValidIdentity_returnsTrue() {' },
          { lineNumber: 7, type: 'delete', content: '    when(identityProvider.get()).thenReturn(mockIdentity("user-1"));' },
          { lineNumber: 8, type: 'delete', content: '    assertTrue(authorizationService.isAuthorized("user-1", "resource"));' },
          { lineNumber: 9, type: 'delete', content: '  }' },
          { lineNumber: 6, type: 'add', content: '  @Test void isAuthorized_withValidToken_returnsTrue() {' },
          { lineNumber: 7, type: 'add', content: '    when(jwtValidator.validate(VALID_TOKEN)).thenReturn(mockPrincipal("user-1"));' },
          { lineNumber: 8, type: 'add', content: '    assertTrue(authorizationService.isAuthorized(VALID_TOKEN, "resource"));' },
          { lineNumber: 9, type: 'add', content: '  }' },
        ]
      },
      {
        filename: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/authorization/BeanTestFactory.java',
        additions: 14,
        deletions: 4,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -8,6 +8,12 @@', type: 'header', content: '@@ -8,6 +8,12 @@' },
          { lineNumber: 8, type: 'context', content: 'public class BeanTestFactory {' },
          { lineNumber: 9, type: 'delete', content: '  public static RequestIdentity mockIdentity(String userId) {' },
          { lineNumber: 10, type: 'delete', content: '    return new RequestIdentity(userId, List.of());' },
          { lineNumber: 11, type: 'delete', content: '  }' },
          { lineNumber: 9, type: 'add', content: '  public static UserPrincipal mockPrincipal(String userId) {' },
          { lineNumber: 10, type: 'add', content: '    return UserPrincipal.builder().userId(userId).roles(List.of()).build();' },
          { lineNumber: 11, type: 'add', content: '  }' },
          { lineNumber: 12, type: 'add', content: '' },
          { lineNumber: 13, type: 'add', content: '  public static String mockJwt(String userId) {' },
          { lineNumber: 14, type: 'add', content: '    return JwtTestHelper.generateToken(userId, List.of());' },
          { lineNumber: 15, type: 'add', content: '  }' },
        ]
      },
    ]
  },
  {
    groupId: 'controllers',
    groupName: 'API Controllers Update for Container Runtime',
    fileCount: 15,
    additions: 248,
    deletions: 183,
    needsReview: true,
    description: 'Controller modifications for container deployment compatibility',
    reviewFocus: 'Check controller endpoint changes and dependency injection updates. Verify controllers work with both Lambda and container runtimes. Review removal of priming resource and UsersClientFactory changes for architectural consistency.',
    files: [
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/QualityGateController.java',
        additions: 18,
        deletions: 14,
        coverage: 86,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,18 +1,22 @@', type: 'header', content: '@@ -1,18 +1,22 @@' },
          { lineNumber: 1, type: 'context', content: 'package io.sonarcloud.qualitygate.controller;' },
          { lineNumber: 2, type: 'context', content: '' },
          { lineNumber: 3, type: 'delete', content: 'import io.sonarcloud.authentication.RequestIdentityProvider;' },
          { lineNumber: 3, type: 'add', content: 'import io.sonarcloud.authentication.JwtTokenValidator;' },
          { lineNumber: 4, type: 'context', content: '' },
          { lineNumber: 5, type: 'context', content: '@RestController' },
          { lineNumber: 6, type: 'context', content: '@RequestMapping("/api/quality-gates")' },
          { lineNumber: 7, type: 'context', content: 'public class QualityGateController {' },
          { lineNumber: 8, type: 'delete', content: '  private final RequestIdentityProvider identityProvider;' },
          { lineNumber: 8, type: 'add', content: '  private final JwtTokenValidator jwtValidator;' },
          { lineNumber: 9, type: 'context', content: '  private final QualityGateService qualityGateService;' },
          { lineNumber: 10, type: 'context', content: '' },
          { lineNumber: 11, type: 'context', content: '  @GetMapping("/{id}")' },
          { lineNumber: 12, type: 'context', content: '  public ResponseEntity<QualityGateDto> getQualityGate(' },
          { lineNumber: 13, type: 'delete', content: '      @RequestHeader("X-Auth-User") String userId) {' },
          { lineNumber: 14, type: 'delete', content: '    RequestIdentity identity = identityProvider.get();' },
          { lineNumber: 13, type: 'add', content: '      @RequestHeader("Authorization") String bearerToken) {' },
          { lineNumber: 14, type: 'add', content: '    UserPrincipal principal = jwtValidator.validate(bearerToken);' },
          { lineNumber: 15, type: 'context', content: '    return qualityGateService.findById(id, principal);' },
          { lineNumber: 16, type: 'context', content: '  }' },
          { lineNumber: 17, type: 'context', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/PrimingResource.java',
        additions: 0,
        deletions: 28,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,28 +0,0 @@', type: 'header', content: '@@ -1,28 +0,0 @@' },
          { lineNumber: 1, type: 'delete', content: 'package io.sonarcloud;' },
          { lineNumber: 2, type: 'delete', content: '' },
          { lineNumber: 3, type: 'delete', content: '// Lambda priming resource - no longer needed in container' },
          { lineNumber: 4, type: 'delete', content: 'public class PrimingResource {' },
          { lineNumber: 5, type: 'delete', content: '  public void prime() {' },
          { lineNumber: 6, type: 'delete', content: '    // Warm up Lambda cold start by pre-loading beans' },
          { lineNumber: 7, type: 'delete', content: '    ApplicationContext ctx = SpringApplication.run(Application.class);' },
          { lineNumber: 8, type: 'delete', content: '    ctx.getBeansOfType(RestController.class);' },
          { lineNumber: 9, type: 'delete', content: '  }' },
          { lineNumber: 10, type: 'delete', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/http/client/user/UsersClientFactory.java',
        additions: 12,
        deletions: 18,
        coverage: 74,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -6,20 +6,14 @@', type: 'header', content: '@@ -6,20 +6,14 @@' },
          { lineNumber: 6, type: 'context', content: 'public class UsersClientFactory {' },
          { lineNumber: 7, type: 'delete', content: '  private UsersClient lambdaClient;' },
          { lineNumber: 8, type: 'delete', content: '  private UsersClient containerClient;' },
          { lineNumber: 9, type: 'delete', content: '' },
          { lineNumber: 10, type: 'delete', content: '  public UsersClient getClient() {' },
          { lineNumber: 11, type: 'delete', content: '    return isLambda() ? lambdaClient : containerClient;' },
          { lineNumber: 12, type: 'delete', content: '  }' },
          { lineNumber: 7, type: 'add', content: '  private UsersClient usersClient;' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: '  public UsersClient getClient() {' },
          { lineNumber: 10, type: 'add', content: '    return usersClient;' },
          { lineNumber: 11, type: 'add', content: '  }' },
        ]
      },
      {
        filename: 'quality-gates/src/main/java/io/sonarcloud/qualitygate/controller/PrivateQualityGateController.java',
        additions: 16,
        deletions: 12,
        coverage: 82,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,14 +1,18 @@', type: 'header', content: '@@ -1,14 +1,18 @@' },
          { lineNumber: 1, type: 'context', content: 'package io.sonarcloud.qualitygate.controller;' },
          { lineNumber: 2, type: 'delete', content: 'import io.sonarcloud.authentication.RequestIdentityProvider;' },
          { lineNumber: 2, type: 'add', content: 'import io.sonarcloud.authentication.JwtTokenValidator;' },
          { lineNumber: 3, type: 'context', content: '' },
          { lineNumber: 4, type: 'context', content: '@RestController' },
          { lineNumber: 5, type: 'context', content: '@RequestMapping("/api/private/quality-gates")' },
          { lineNumber: 6, type: 'context', content: 'public class PrivateQualityGateController {' },
          { lineNumber: 7, type: 'delete', content: '  private final RequestIdentityProvider identityProvider;' },
          { lineNumber: 7, type: 'add', content: '  private final JwtTokenValidator jwtValidator;' },
          { lineNumber: 8, type: 'context', content: '  private final QualityGateService qualityGateService;' },
          { lineNumber: 9, type: 'context', content: '}' },
        ]
      },
      {
        filename: '... 11 more controller files',
        additions: 202,
        deletions: 111,
        coverage: 84,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: 1, type: 'context', content: '// PrivateProjectAssociationsController.java' },
          { lineNumber: 2, type: 'context', content: '// PrivateQualityGateConditionsController.java' },
          { lineNumber: 3, type: 'context', content: '// PrivateQualityGateDefaultsController.java' },
          { lineNumber: 4, type: 'context', content: '// PrivateQualityGateSettingsController.java' },
          { lineNumber: 5, type: 'context', content: '// PrivateQualityGateStatusesController.java' },
          { lineNumber: 6, type: 'context', content: '// ProjectAssociationsController.java' },
          { lineNumber: 7, type: 'context', content: '// QualityGateConditionsController.java' },
          { lineNumber: 8, type: 'context', content: '// QualityGateDefaultsController.java' },
          { lineNumber: 9, type: 'context', content: '// QualityGateSettingsController.java' },
          { lineNumber: 10, type: 'context', content: '// QualityGateStatusesController.java' },
          { lineNumber: 11, type: 'context', content: '// PrivateQualityGatesEvaluationController.java' },
          { lineNumber: 12, type: 'context', content: '' },
          { lineNumber: 13, type: 'context', content: '// All controllers updated:' },
          { lineNumber: 14, type: 'delete', content: '//   - Removed RequestIdentityProvider dependency' },
          { lineNumber: 14, type: 'add', content: '//   + Added JwtTokenValidator dependency' },
          { lineNumber: 15, type: 'delete', content: '//   - Removed @RequestHeader("X-Auth-User") String userId' },
          { lineNumber: 15, type: 'add', content: '//   + Added @RequestHeader("Authorization") String bearerToken' },
        ]
      },
    ]
  },
  {
    groupId: 'integration-tests',
    groupName: 'Integration Tests Refactor',
    fileCount: 26,
    additions: 412,
    deletions: 287,
    needsReview: true,
    description: 'Comprehensive updates to integration tests for container compatibility',
    reviewFocus: 'Verify integration tests updated for new authentication mechanism using JwtTestHelper. Check test setup changes in abstract base classes. Ensure all IT classes maintain coverage while adapting to refactored authorization and controller layers.',
    files: [
      {
        filename: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/JwtTestHelper.java',
        additions: 54,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,54 @@', type: 'header', content: '@@ -0,0 +1,54 @@' },
          { lineNumber: 1, type: 'add', content: 'package io.sonarcloud.qualitygate.it;' },
          { lineNumber: 2, type: 'add', content: '' },
          { lineNumber: 3, type: 'add', content: 'public class JwtTestHelper {' },
          { lineNumber: 4, type: 'add', content: '' },
          { lineNumber: 5, type: 'add', content: '  private static final String SECRET = "test-secret-key-for-integration-tests";' },
          { lineNumber: 6, type: 'add', content: '' },
          { lineNumber: 7, type: 'add', content: '  public static String generateToken(String userId, List<String> roles) {' },
          { lineNumber: 8, type: 'add', content: '    return Jwts.builder()' },
          { lineNumber: 9, type: 'add', content: '        .setSubject(userId)' },
          { lineNumber: 10, type: 'add', content: '        .claim("roles", roles)' },
          { lineNumber: 11, type: 'add', content: '        .setExpiration(new Date(System.currentTimeMillis() + 3600_000))' },
          { lineNumber: 12, type: 'add', content: '        .signWith(Keys.hmacShaKeyFor(SECRET.getBytes()))' },
          { lineNumber: 13, type: 'add', content: '        .compact();' },
          { lineNumber: 14, type: 'add', content: '  }' },
          { lineNumber: 15, type: 'add', content: '' },
          { lineNumber: 16, type: 'add', content: '  public static String adminToken() {' },
          { lineNumber: 17, type: 'add', content: '    return generateToken("admin-user", List.of("ADMIN", "USER"));' },
          { lineNumber: 18, type: 'add', content: '  }' },
          { lineNumber: 19, type: 'add', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/src/test/java/io/sonarcloud/qualitygate/it/ControllerBaseIT.java',
        additions: 22,
        deletions: 18,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,22 +1,26 @@', type: 'header', content: '@@ -1,22 +1,26 @@' },
          { lineNumber: 1, type: 'context', content: 'package io.sonarcloud.qualitygate.it;' },
          { lineNumber: 2, type: 'context', content: '' },
          { lineNumber: 3, type: 'context', content: '@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)' },
          { lineNumber: 4, type: 'context', content: 'public abstract class ControllerBaseIT {' },
          { lineNumber: 5, type: 'delete', content: '  protected String authHeader(String userId) {' },
          { lineNumber: 6, type: 'delete', content: '    return "X-Auth-User: " + userId;' },
          { lineNumber: 7, type: 'delete', content: '  }' },
          { lineNumber: 5, type: 'add', content: '  protected String authHeader(String userId) {' },
          { lineNumber: 6, type: 'add', content: '    return "Bearer " + JwtTestHelper.generateToken(userId, List.of("USER"));' },
          { lineNumber: 7, type: 'add', content: '  }' },
          { lineNumber: 8, type: 'add', content: '' },
          { lineNumber: 9, type: 'add', content: '  protected String adminAuthHeader() {' },
          { lineNumber: 10, type: 'add', content: '    return "Bearer " + JwtTestHelper.adminToken();' },
          { lineNumber: 11, type: 'add', content: '  }' },
          { lineNumber: 12, type: 'context', content: '}' },
        ]
      },
      {
        filename: '... 24 more IT files',
        additions: 336,
        deletions: 269,
        coverage: 78,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: 1, type: 'context', content: '// Abstract*ControllerIT.java (5 files): Updated base classes' },
          { lineNumber: 2, type: 'context', content: '// *ControllerDeleteIT.java / GetIT.java / PatchIT.java / PostIT.java' },
          { lineNumber: 3, type: 'context', content: '// ProjectAssociations*IT.java, QualityGate*IT.java (16 files)' },
          { lineNumber: 4, type: 'context', content: '// InterDomainCommunicationIT.java' },
          { lineNumber: 5, type: 'context', content: '' },
          { lineNumber: 6, type: 'context', content: '// Common pattern across all IT files:' },
          { lineNumber: 7, type: 'delete', content: '// .header("X-Auth-User", TEST_USER_ID)' },
          { lineNumber: 7, type: 'add', content: '// .header("Authorization", JwtTestHelper.generateToken(TEST_USER_ID, roles))' },
          { lineNumber: 8, type: 'delete', content: 'mockMvc.perform(get("/api/...").header("X-Auth-User", userId))' },
          { lineNumber: 8, type: 'add', content: 'mockMvc.perform(get("/api/...").header("Authorization", authHeader(userId)))' },
        ]
      },
    ]
  },
  {
    groupId: 'auth-cleanup',
    groupName: 'Authentication Model Cleanup',
    fileCount: 3,
    additions: 0,
    deletions: 84,
    needsReview: true,
    description: 'Removal of RequestIdentity and RequestIdentityProvider classes with related tests',
    reviewFocus: 'Verify these authentication classes are fully replaced by alternative mechanism. Ensure no remaining references exist. Confirm new authentication approach in controllers and tests adequately replaces removed functionality.',
    files: [
      {
        filename: 'quality-gates/shared/src/main/java/io/sonarcloud/authentication/RequestIdentity.java',
        additions: 0,
        deletions: 32,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,32 +0,0 @@', type: 'header', content: '@@ -1,32 +0,0 @@' },
          { lineNumber: 1, type: 'delete', content: 'package io.sonarcloud.authentication;' },
          { lineNumber: 2, type: 'delete', content: '' },
          { lineNumber: 3, type: 'delete', content: '/**' },
          { lineNumber: 4, type: 'delete', content: ' * @deprecated Replaced by JWT-based authentication.' },
          { lineNumber: 5, type: 'delete', content: ' * Use JwtTokenValidator and UserPrincipal instead.' },
          { lineNumber: 6, type: 'delete', content: ' */' },
          { lineNumber: 7, type: 'delete', content: 'public class RequestIdentity {' },
          { lineNumber: 8, type: 'delete', content: '  private final String userId;' },
          { lineNumber: 9, type: 'delete', content: '  private final List<String> permissions;' },
          { lineNumber: 10, type: 'delete', content: '' },
          { lineNumber: 11, type: 'delete', content: '  public RequestIdentity(String userId, List<String> permissions) {' },
          { lineNumber: 12, type: 'delete', content: '    this.userId = userId;' },
          { lineNumber: 13, type: 'delete', content: '    this.permissions = Collections.unmodifiableList(permissions);' },
          { lineNumber: 14, type: 'delete', content: '  }' },
          { lineNumber: 15, type: 'delete', content: '' },
          { lineNumber: 16, type: 'delete', content: '  public String getUserId() { return userId; }' },
          { lineNumber: 17, type: 'delete', content: '  public List<String> getPermissions() { return permissions; }' },
          { lineNumber: 18, type: 'delete', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/shared/src/main/java/io/sonarcloud/authentication/RequestIdentityProvider.java',
        additions: 0,
        deletions: 28,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,28 +0,0 @@', type: 'header', content: '@@ -1,28 +0,0 @@' },
          { lineNumber: 1, type: 'delete', content: 'package io.sonarcloud.authentication;' },
          { lineNumber: 2, type: 'delete', content: '' },
          { lineNumber: 3, type: 'delete', content: '/**' },
          { lineNumber: 4, type: 'delete', content: ' * @deprecated Replaced by JwtTokenValidator.' },
          { lineNumber: 5, type: 'delete', content: ' * Extract user identity from JWT Authorization header instead.' },
          { lineNumber: 6, type: 'delete', content: ' */' },
          { lineNumber: 7, type: 'delete', content: '@Component' },
          { lineNumber: 8, type: 'delete', content: 'public class RequestIdentityProvider {' },
          { lineNumber: 9, type: 'delete', content: '' },
          { lineNumber: 10, type: 'delete', content: '  public RequestIdentity get() {' },
          { lineNumber: 11, type: 'delete', content: '    // Read from Lambda context thread-local' },
          { lineNumber: 12, type: 'delete', content: '    return LambdaContextHolder.getIdentity();' },
          { lineNumber: 13, type: 'delete', content: '  }' },
          { lineNumber: 14, type: 'delete', content: '}' },
        ]
      },
      {
        filename: 'quality-gates/shared/src/test/java/io/sonarcloud/authentication/RequestIdentityProviderTest.java',
        additions: 0,
        deletions: 24,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,24 +0,0 @@', type: 'header', content: '@@ -1,24 +0,0 @@' },
          { lineNumber: 1, type: 'delete', content: 'package io.sonarcloud.authentication;' },
          { lineNumber: 2, type: 'delete', content: '' },
          { lineNumber: 3, type: 'delete', content: '// Tests for RequestIdentityProvider - removed with the class' },
          { lineNumber: 4, type: 'delete', content: 'class RequestIdentityProviderTest {' },
          { lineNumber: 5, type: 'delete', content: '  @Test void get_returnsIdentityFromLambdaContext() {' },
          { lineNumber: 6, type: 'delete', content: '    LambdaContextHolder.set(new RequestIdentity("user-1", List.of()));' },
          { lineNumber: 7, type: 'delete', content: '    RequestIdentity result = new RequestIdentityProvider().get();' },
          { lineNumber: 8, type: 'delete', content: '    assertEquals("user-1", result.getUserId());' },
          { lineNumber: 9, type: 'delete', content: '  }' },
          { lineNumber: 10, type: 'delete', content: '}' },
        ]
      },
    ]
  },
  {
    groupId: 'openapi-snapshots',
    groupName: 'OpenAPI Specs & Infrastructure Snapshots',
    fileCount: 8,
    additions: 218,
    deletions: 94,
    needsReview: true,
    description: 'New Lambda API definitions and updated infrastructure snapshot tests for all environments',
    reviewFocus: 'Review new openapi-lambda.yaml for API contract changes. Compare openapi.yaml modifications. Verify infrastructure snapshot changes reflect expected ECS resources, networking, and service configurations across Dev/Staging/Prod.',
    files: [
      {
        filename: 'quality-gates/quality-gates-platform/api-definitions/openapi-lambda.yaml',
        additions: 68,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -0,0 +1,68 @@', type: 'header', content: '@@ -0,0 +1,68 @@' },
          { lineNumber: 1, type: 'add', content: 'openapi: 3.0.3' },
          { lineNumber: 2, type: 'add', content: 'info:' },
          { lineNumber: 3, type: 'add', content: '  title: Quality Gates Lambda API (Legacy)' },
          { lineNumber: 4, type: 'add', content: '  description: API spec for Lambda version - kept for backwards compatibility' },
          { lineNumber: 5, type: 'add', content: '  version: 1.0.0' },
          { lineNumber: 6, type: 'add', content: 'servers:' },
          { lineNumber: 7, type: 'add', content: '  - url: https://{lambda-endpoint}/api' },
          { lineNumber: 8, type: 'add', content: 'paths:' },
          { lineNumber: 9, type: 'add', content: '  /quality-gates/{id}:' },
          { lineNumber: 10, type: 'add', content: '    get:' },
          { lineNumber: 11, type: 'add', content: '      summary: Get quality gate by ID' },
          { lineNumber: 12, type: 'add', content: '      parameters:' },
          { lineNumber: 13, type: 'add', content: '        - name: id' },
          { lineNumber: 14, type: 'add', content: '          in: path' },
          { lineNumber: 15, type: 'add', content: '          required: true' },
          { lineNumber: 16, type: 'add', content: '          schema:' },
          { lineNumber: 17, type: 'add', content: '            type: string' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-platform/api-definitions/openapi.yaml',
        additions: 14,
        deletions: 8,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,10 +1,16 @@', type: 'header', content: '@@ -1,10 +1,16 @@' },
          { lineNumber: 1, type: 'context', content: 'openapi: 3.0.3' },
          { lineNumber: 2, type: 'context', content: 'info:' },
          { lineNumber: 3, type: 'context', content: '  title: Quality Gates API' },
          { lineNumber: 4, type: 'delete', content: '  version: 1.2.0' },
          { lineNumber: 4, type: 'add', content: '  version: 2.0.0' },
          { lineNumber: 5, type: 'context', content: 'servers:' },
          { lineNumber: 6, type: 'delete', content: '  - url: https://{lambda-endpoint}/api' },
          { lineNumber: 6, type: 'add', content: '  - url: https://{service-endpoint}/api' },
          { lineNumber: 7, type: 'context', content: 'components:' },
          { lineNumber: 8, type: 'context', content: '  securitySchemes:' },
          { lineNumber: 9, type: 'delete', content: '    LambdaAuth:' },
          { lineNumber: 10, type: 'delete', content: '      type: apiKey' },
          { lineNumber: 11, type: 'delete', content: '      in: header' },
          { lineNumber: 12, type: 'delete', content: '      name: X-Auth-User' },
          { lineNumber: 9, type: 'add', content: '    BearerAuth:' },
          { lineNumber: 10, type: 'add', content: '      type: http' },
          { lineNumber: 11, type: 'add', content: '      scheme: bearer' },
          { lineNumber: 12, type: 'add', content: '      bearerFormat: JWT' },
        ]
      },
      {
        filename: 'test_full_template_with_snapshot[Dev].json (quality-gates)',
        additions: 48,
        deletions: 28,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -12,16 +12,18 @@', type: 'header', content: '@@ -12,16 +12,18 @@' },
          { lineNumber: 12, type: 'context', content: '  "Resources": {' },
          { lineNumber: 13, type: 'delete', content: '    "QualityGatesLambdaFunction": {' },
          { lineNumber: 14, type: 'delete', content: '      "Type": "AWS::Lambda::Function",' },
          { lineNumber: 15, type: 'delete', content: '      "Properties": {' },
          { lineNumber: 16, type: 'delete', content: '        "FunctionName": "quality-gates-dev",' },
          { lineNumber: 17, type: 'delete', content: '        "Runtime": "java17",' },
          { lineNumber: 18, type: 'delete', content: '        "Handler": "io.sonarcloud.Handler::handleRequest"' },
          { lineNumber: 19, type: 'delete', content: '      }' },
          { lineNumber: 13, type: 'add', content: '    "QualityGatesEcsService": {' },
          { lineNumber: 14, type: 'add', content: '      "Type": "AWS::ECS::Service",' },
          { lineNumber: 15, type: 'add', content: '      "Properties": {' },
          { lineNumber: 16, type: 'add', content: '        "ServiceName": "quality-gates-dev",' },
          { lineNumber: 17, type: 'add', content: '        "Cluster": { "Ref": "QualityGatesCluster" },' },
          { lineNumber: 18, type: 'add', content: '        "DesiredCount": 2,' },
          { lineNumber: 19, type: 'add', content: '        "LaunchType": "FARGATE"' },
          { lineNumber: 20, type: 'add', content: '      }' },
        ]
      },
      {
        filename: '... 5 more snapshot files',
        additions: 88,
        deletions: 58,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: 1, type: 'context', content: '// test_full_template_with_snapshot[Staging].json (quality-gates)' },
          { lineNumber: 2, type: 'context', content: '// test_full_template_with_snapshot[Prod].json (quality-gates)' },
          { lineNumber: 3, type: 'context', content: '// test_full_template_with_snapshot[Dev].json (quality-gates-events)' },
          { lineNumber: 4, type: 'context', content: '// test_full_template_with_snapshot[Staging].json (quality-gates-events)' },
          { lineNumber: 5, type: 'context', content: '// test_full_template_with_snapshot[Prod].json (quality-gates-events)' },
          { lineNumber: 6, type: 'context', content: '' },
          { lineNumber: 7, type: 'context', content: '// All snapshots updated: Lambda resources removed, ECS resources added' },
          { lineNumber: 8, type: 'delete', content: '"Type": "AWS::Lambda::Function"' },
          { lineNumber: 8, type: 'add', content: '"Type": "AWS::ECS::Service"' },
          { lineNumber: 9, type: 'delete', content: '"Type": "AWS::Lambda::EventSourceMapping"' },
          { lineNumber: 9, type: 'add', content: '"Type": "AWS::ElasticLoadBalancingV2::TargetGroup"' },
        ]
      },
    ]
  },
  {
    groupId: 'build-config',
    groupName: 'Build Config & Dependency Updates',
    fileCount: 3,
    additions: 28,
    deletions: 12,
    needsReview: true,
    description: 'Gradle build file and dependency version updates',
    reviewFocus: 'Review build.gradle changes for new dependencies supporting container runtime and JMS. Check libs.versions.toml for version updates. Ensure dependency changes are compatible and don\'t introduce security vulnerabilities.',
    files: [
      {
        filename: 'quality-gates/quality-gates-lambda/build.gradle',
        additions: 16,
        deletions: 8,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -18,10 +18,16 @@', type: 'header', content: '@@ -18,10 +18,16 @@' },
          { lineNumber: 18, type: 'context', content: 'dependencies {' },
          { lineNumber: 19, type: 'delete', content: "  implementation 'com.amazonaws:aws-lambda-java-core:1.2.2'" },
          { lineNumber: 20, type: 'delete', content: "  implementation 'com.amazonaws:aws-lambda-java-events:3.11.3'" },
          { lineNumber: 21, type: 'delete', content: "  implementation 'com.amazonaws:aws-java-sdk-lambda:1.12.472'" },
          { lineNumber: 19, type: 'add', content: "  implementation 'org.springframework.boot:spring-boot-starter-web'" },
          { lineNumber: 20, type: 'add', content: "  implementation 'org.springframework.boot:spring-boot-starter-actuator'" },
          { lineNumber: 21, type: 'add', content: "  implementation 'org.springframework.boot:spring-boot-starter-activemq'" },
          { lineNumber: 22, type: 'add', content: "  implementation 'net.logstash.logback:logstash-logback-encoder:7.4'" },
          { lineNumber: 23, type: 'context', content: "  implementation 'org.springframework.boot:spring-boot-starter-data-jpa'" },
          { lineNumber: 24, type: 'context', content: '}' },
        ]
      },
      {
        filename: 'quality-gates-evaluation/quality-gates-evaluation-lambda/build.gradle',
        additions: 8,
        deletions: 4,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -12,6 +12,10 @@', type: 'header', content: '@@ -12,6 +12,10 @@' },
          { lineNumber: 12, type: 'context', content: 'dependencies {' },
          { lineNumber: 13, type: 'delete', content: "  implementation 'com.amazonaws:aws-lambda-java-core:1.2.2'" },
          { lineNumber: 13, type: 'add', content: "  implementation 'org.springframework.boot:spring-boot-starter-web'" },
          { lineNumber: 14, type: 'add', content: "  implementation 'org.springframework.boot:spring-boot-starter-activemq'" },
          { lineNumber: 15, type: 'context', content: '}' },
        ]
      },
      {
        filename: 'gradle/libs.versions.toml',
        additions: 4,
        deletions: 0,
        coverage: 0,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -14,6 +14,10 @@', type: 'header', content: '@@ -14,6 +14,10 @@' },
          { lineNumber: 14, type: 'context', content: '[versions]' },
          { lineNumber: 15, type: 'context', content: 'spring-boot = "3.2.4"' },
          { lineNumber: 16, type: 'context', content: 'logback = "1.4.14"' },
          { lineNumber: 17, type: 'add', content: 'logstash-logback = "7.4"' },
          { lineNumber: 18, type: 'add', content: 'activemq = "5.18.3"' },
          { lineNumber: 19, type: 'context', content: '' },
        ]
      },
    ]
  },
  {
    groupId: 'platform-tests',
    groupName: 'Platform Test Updates',
    fileCount: 3,
    additions: 78,
    deletions: 34,
    needsReview: true,
    description: 'Python platform test modifications for infrastructure changes',
    reviewFocus: 'Verify test_app.py, test_service.py, and test_snapshots.py properly validate new ECS infrastructure. Ensure tests cover container service configuration, networking, and deployment scenarios for quality gates platform.',
    files: [
      {
        filename: 'quality-gates/quality-gates-platform/tests/test_service.py',
        additions: 38,
        deletions: 18,
        coverage: 82,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,22 +1,28 @@', type: 'header', content: '@@ -1,22 +1,28 @@' },
          { lineNumber: 1, type: 'context', content: 'import pytest' },
          { lineNumber: 2, type: 'context', content: 'from quality_gates_platform.service import QualityGatesPlatformService' },
          { lineNumber: 3, type: 'context', content: '' },
          { lineNumber: 4, type: 'context', content: 'class TestQualityGatesPlatformService:' },
          { lineNumber: 5, type: 'delete', content: '    def test_creates_lambda_function(self, stack):' },
          { lineNumber: 6, type: 'delete', content: '        template = Template.from_stack(stack)' },
          { lineNumber: 7, type: 'delete', content: '        template.has_resource("AWS::Lambda::Function", {' },
          { lineNumber: 8, type: 'delete', content: '            "Properties": {"Runtime": "java17"}' },
          { lineNumber: 9, type: 'delete', content: '        })' },
          { lineNumber: 5, type: 'add', content: '    def test_creates_ecs_service(self, stack):' },
          { lineNumber: 6, type: 'add', content: '        template = Template.from_stack(stack)' },
          { lineNumber: 7, type: 'add', content: '        template.has_resource("AWS::ECS::Service", {' },
          { lineNumber: 8, type: 'add', content: '            "Properties": {' },
          { lineNumber: 9, type: 'add', content: '                "LaunchType": "FARGATE",' },
          { lineNumber: 10, type: 'add', content: '                "DesiredCount": 2' },
          { lineNumber: 11, type: 'add', content: '            }' },
          { lineNumber: 12, type: 'add', content: '        })' },
          { lineNumber: 13, type: 'context', content: '' },
          { lineNumber: 14, type: 'add', content: '    def test_creates_load_balancer(self, stack):' },
          { lineNumber: 15, type: 'add', content: '        template = Template.from_stack(stack)' },
          { lineNumber: 16, type: 'add', content: '        template.has_resource("AWS::ElasticLoadBalancingV2::LoadBalancer", {' },
          { lineNumber: 17, type: 'add', content: '            "Properties": {"Scheme": "internet-facing"}' },
          { lineNumber: 18, type: 'add', content: '        })' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-platform/tests/test_app.py',
        additions: 22,
        deletions: 12,
        coverage: 79,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -1,14 +1,20 @@', type: 'header', content: '@@ -1,14 +1,20 @@' },
          { lineNumber: 1, type: 'context', content: 'import pytest' },
          { lineNumber: 2, type: 'context', content: 'import aws_cdk as cdk' },
          { lineNumber: 3, type: 'context', content: 'from quality_gates_platform.service import QualityGatesPlatformService' },
          { lineNumber: 4, type: 'add', content: 'from quality_gates_platform.ecs_service import QualityGatesEcsService' },
          { lineNumber: 5, type: 'context', content: '' },
          { lineNumber: 6, type: 'delete', content: 'def test_app_synthesizes_lambda():' },
          { lineNumber: 7, type: 'delete', content: '    app = cdk.App()' },
          { lineNumber: 8, type: 'delete', content: '    stack = QualityGatesPlatformService(app, "Test-Lambda")' },
          { lineNumber: 9, type: 'delete', content: '    assert stack.lambda_function is not None' },
          { lineNumber: 6, type: 'add', content: 'def test_app_synthesizes_container():' },
          { lineNumber: 7, type: 'add', content: '    app = cdk.App()' },
          { lineNumber: 8, type: 'add', content: '    stack = QualityGatesPlatformService(app, "Test-Container")' },
          { lineNumber: 9, type: 'add', content: '    assert stack.ecs_service is not None' },
          { lineNumber: 10, type: 'add', content: '    assert stack.alb is not None' },
        ]
      },
      {
        filename: 'quality-gates/quality-gates-platform/tests/test_snapshots.py',
        additions: 18,
        deletions: 4,
        coverage: 86,
        duplications: 0,
        issues: 0,
        expanded: false,
        checked: false,
        changes: [
          { lineNumber: '@@ -8,6 +8,16 @@', type: 'header', content: '@@ -8,6 +8,16 @@' },
          { lineNumber: 8, type: 'context', content: 'class TestSnapshots:' },
          { lineNumber: 9, type: 'context', content: '    @pytest.mark.parametrize("env", ["Dev", "Staging", "Prod"])' },
          { lineNumber: 10, type: 'context', content: '    def test_full_template_with_snapshot(self, env, snapshot):' },
          { lineNumber: 11, type: 'delete', content: '        # Verify Lambda resources in snapshot' },
          { lineNumber: 12, type: 'delete', content: '        assert "AWS::Lambda::Function" in template["Resources"]' },
          { lineNumber: 11, type: 'add', content: '        # Verify ECS resources in snapshot' },
          { lineNumber: 12, type: 'add', content: '        assert "AWS::ECS::Service" in template["Resources"]' },
          { lineNumber: 13, type: 'add', content: '        assert "AWS::ECS::TaskDefinition" in template["Resources"]' },
          { lineNumber: 14, type: 'add', content: '        assert "AWS::ElasticLoadBalancingV2::LoadBalancer" in template["Resources"]' },
          { lineNumber: 15, type: 'context', content: '        assert template == snapshot' },
          { lineNumber: 16, type: 'context', content: '    }' },
        ]
      },
    ]
  },
];
